<!DOCTYPE html>
<html>
<head>
    <script src='https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js'></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Trivia</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        * {
            color: #666667;
        }
        .quest-div {
            background-color: #66b2ff;
            width: 250px;
            height: 250px;
        }
        li {
            list-style-type: none;
        }
    </style>
    <script>
        $(document).ready(function() {
            const quizDiv = document.getElementById('quiz');
            let quiz;
            let score = 0;
            let scoreElement = document.getElementById('score')
            scoreElement.textContent = `Score: ${score}`


            $.get(
                'https://opentdb.com/api.php?amount=10&category=17&difficulty=medium',
                response => {
                    quiz = response.results;
                    console.log(quiz)
                    
                    let counter = 0;
                    // Iterate thru ea. of the 10 question objects
                    quiz.forEach(questAns => {
                        // Create Question DIV
                        let questDiv = document.createElement('div')
                        questDiv.className = "quest-div";

                        // Create Question element
                        let questElement = document.createElement('p');
                        questElement.textContent = questAns.question;


                        // Create answer ul
                        let ansUL = document.createElement('ul');
                        ansUL.className = 'ans-ul';

                        // Create answers array
                        let answers = questAns.incorrect_answers
                        answers.splice(
                            Math.random()*answers.length,
                            0, 
                            questAns.correct_answer
                        );
                        // Create answer label and radio buttons
                        answers.forEach(answer => {

                            // create radio buttons
                            let ansRadio = document.createElement("INPUT");
                            ansRadio.setAttribute("type", "radio");
                            ansRadio.setAttribute("name", counter)
                            ansRadio.value = answer;

                            // Create label and set its text to answer
                            let ansLabel = document.createElement("LABEL");
                            ansLabel.textContent = answer;

                            // Append answer label and radio button to answer li
                            let li = document.createElement('li');
                            li.appendChild(ansRadio);
                            li.appendChild(ansLabel);
                            // Append li to ul
                            ansUL.appendChild(li)
                        })

                    questDiv.appendChild(questElement);
                    questDiv.appendChild(ansUL);
                    quizDiv.appendChild(questDiv);
                    counter++; // After building ea. question increase counter
                }) // End iteration of creating questions
            }) // End jQuery Get

                

            document.addEventListener('click',
                event => {
                    if (event.target.type === 'radio') {
                        let answer = event.target.value;
                        let index = event.target.name;
                        console.log(quiz[index])
                        if (quiz[index].correct_answer === answer) {
                            console.log('Hooray')
                            score++;
                            scoreElement.textContent = `Score: ${score}`;
                        }
                        else {
                            console.log('Sorry, thats wrong')
                        }
                    }
                });
        })
    </script>
</head>
<body>
    <h3 id="score"></h3>
    <div id="quiz"></div>
</body>
</html>